CREATE DATABASE PLAYER;

CREATE TABLE PLAYER(
	PID VARCHAR(10) PRIMARY KEY,
	PNAME CHARACTER(40) NOT NULL,
	NATIONALITY CHARACTER(20) NOT NULL,
	TYPE CHARACTER(20) CHECK (TYPE = "WICKET_KEEPER" OR TYPE = "BATSMAN" OR TYPE = "ALL_ROUNDER" OR TYPE = "BOWLER")
);

CREATE TABLE TEAM(
	TID VARCHAR(10) NOT NULL,
	TNAME CHARACTER(40) NOT NULL,
	PID VARCHAR(10) NOT NULL REFERENCES PLAYER(PID),
    PRIMARY KEY(TID, TNAME, PID)
);

CREATE TABLE CRICKET_MATCH(
	MID VARCHAR(10) NOT NULL,
	PID VARCHAR(10) NOT NULL REFERENCES PLAYER(PID),
	RUNS_SCORED INT NOT NULL,
	WICKETS_TAKEN INT NOT NULL,
    PRIMARY KEY(MID, PID)
);

INSERT INTO PLAYER (PID,PNAME,NATIONALITY,TYPE) VALUES
	('P001', 'ROHIT SHARMA', 'INDIAN', 'BATSMAN'), ('P002', 'VIRAT KOHLI', 'INDIAN', 'BATSMAN'),
	('P003', 'AB DE VILLIERS', 'SOUTH AFRICAN', 'BATSMAN'), ('P004', 'RISHABH PANT', 'INDIAN', 'WICKET_KEEPER'),
	('P005', 'RAVINDRA JADEJA', 'INDIAN', 'ALL_ROUNDER'), ('P006', 'RAVICHANDRAN ASHWIN', 'INDIAN', 'ALL_ROUNDER'),
	('P007', 'KL RAHUL', 'INDIAN', 'WICKET_KEEPER'), ('P008', 'JASPRIT BUMRAH', 'INDIAN', 'BOWLER'),
	('P009', 'MOHAMMED SHAMI', 'INDIAN', 'BOWLER'), ('P010', 'MOHAMMED SIRAJ', 'INDIAN', 'BOWLER'),
	('P011', 'BEN STOKES', 'ENGLISH', 'ALL_ROUNDER'), ('P012', 'NATHAN LYON', 'AUSTRALIAN', 'BOWLER'), ('P013', 'TOM LATHAM', 'NEW ZEALAND', 'WICKET_KEEPER');

INSERT INTO TEAM (TID,TNAME,PID) VALUES
	('T001', 'TEAM-A', 'P001'), ('T001', 'TEAM-A', 'P007'), ('T001', 'TEAM-A', 'P011'), ('T001', 'TEAM-A', 'P006'),
	('T002', 'TEAM-B', 'P002'), ('T002', 'TEAM-B', 'P004'), ('T002', 'TEAM-B', 'P005'), ('T002', 'TEAM-B', 'P010'),
	('T003', 'TEAM-C', 'P003'), ('T003', 'TEAM-C', 'P008'), ('T003', 'TEAM-C', 'P013'), ('T003', 'TEAM-C', 'P009'), ('T003', 'TEAM-C', 'P012');

INSERT INTO CRICKET_MATCH (MID,PID,RUNS_SCORED,WICKETS_TAKEN) VALUES
	('M001', 'P005', 52, 2), ('M001', 'P006', 34, 1), ('M001', 'P010', 18, 4), ('M001', 'P011', 38, 0),
	('M002', 'P005', 34, 1), ('M002', 'P008', 12, 1), ('M002', 'P009', 28, 4), ('M002', 'P012', 22, 1),
	('M003', 'P006', 24, 2), ('M003', 'P008', 05, 3), ('M003', 'P010', 12, 1), ('M003', 'P009', 16, 1);

--Write Sql Query to list the name of the players who has scored more than 30 runs and atleast 2 wickets in a single match...
SELECT PLAYER.PID,PNAME FROM PLAYER,CRICKET_MATCH WHERE PLAYER.PID = CRICKET_MATCH.PID AND RUNS_SCORED > 20 AND WICKETS_TAKEN >= 2 ORDER BY PID;

--Write Sql Query to find which type of players are mostly registered...
SELECT TYPE,COUNT(TYPE) AS "TOTAL COUNT" FROM PLAYER GROUP BY TYPE ORDER BY COUNT(TYPE) DESC LIMIT 1;
