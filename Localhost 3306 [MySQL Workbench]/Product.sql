CREATE DATABASE PRODUCT;
USE PRODUCT;
CREATE TABLE CLIENT_MASTER (
	CLIENTNUMBER VARCHAR(10) PRIMARY KEY,
    CLIENTNAME VARCHAR(40) NOT NULL
);
INSERT INTO CLIENT_MASTER (CLIENTNUMBER, CLIENTNAME) VALUES ('C00001','ARPAN MITRA'),('C00002','KREETIKA CHOWDHURY'),('C00003','KALICHARAN BOSE'),('C00004','RAMEN SEN'),('C00005','ANUPAMA DEY');

CREATE TABLE PRODUCT_MASTER (
	PRODUCTNUMBER VARCHAR(10) PRIMARY KEY,
    DESCRIPTION VARCHAR(50) NOT NULL
);
INSERT INTO PRODUCT_MASTER VALUES ('P00001','REDMI 9 POWER');
INSERT INTO PRODUCT_MASTER VALUES ('P00002','LIFEBUOY LB DISINFECTANT SPRAY');
INSERT INTO PRODUCT_MASTER VALUES ('P00003','DUBE CAKE MOULD');
INSERT INTO PRODUCT_MASTER VALUES ('P00004','3 LAYER 36 GRID PLASTIC EGGS STORAGE');
INSERT INTO PRODUCT_MASTER VALUES ('P00005','BLUETOOTH LED MUSIC BULB');
INSERT INTO PRODUCT_MASTER VALUES ('P00006','BLACK LEATHER CARD HOLDER');
INSERT INTO PRODUCT_MASTER VALUES ('P00007','AROPANA CARD READER');
INSERT INTO PRODUCT_MASTER VALUES ('P00008','STEAM VAPORIZER');
INSERT INTO PRODUCT_MASTER VALUES ('P00009','TAGG VERVE ENGAGE WITH BLUETOOTH CALLING');
INSERT INTO PRODUCT_MASTER VALUES ('P00010','BOAT ROCKERZ 255 PRO+');

CREATE TABLE SALES_ORDER (
	ORDERNUMBER VARCHAR(40) PRIMARY KEY,
    CLIENTNUMBER VARCHAR(10) NOT NULL,
    ORDERDATES DATE,
    FOREIGN KEY(CLIENTNUMBER) REFERENCES CLIENT_MASTER(CLIENTNUMBER)
);

INSERT INTO SALES_ORDER VALUES ('221-4713988-62229000','C00004','2021-04-09');
INSERT INTO SALES_ORDER VALUES ('221-7255722-06001000','C00002','2021-05-11');
INSERT INTO SALES_ORDER VALUES ('221-7500908-94953000','C00001','2021-05-16');
INSERT INTO SALES_ORDER VALUES ('223-9854674-14514000','C00001','2022-01-29');
INSERT INTO SALES_ORDER VALUES ('225-6366641-68866000','C00004','2022-08-10');
INSERT INTO SALES_ORDER VALUES ('225-6366641-68456526','C00002','2022-08-08');
INSERT INTO SALES_ORDER VALUES ('225-6366641-66735675','C00005','2022-08-10');
INSERT INTO SALES_ORDER VALUES ('225-6367346-28388000','C00003','2022-08-10');
INSERT INTO SALES_ORDER VALUES ('225-6552008-45781000','C00005','2022-08-06');
INSERT INTO SALES_ORDER VALUES ('226-2785221-01930000','C00004','2022-10-21');

CREATE TABLE SALES_ORDER_DETAILS (
	ORDERNUMBER VARCHAR(40) NOT NULL,
    PRODUCTNUMBER VARCHAR(10) NOT NULL,
    ORDERQUANTITY INT NOT NULL,
    FOREIGN KEY(ORDERNUMBER) REFERENCES SALES_ORDER(ORDERNUMBER),
    FOREIGN KEY(PRODUCTNUMBER) REFERENCES PRODUCT_MASTER(PRODUCTNUMBER)
);
INSERT INTO SALES_ORDER_DETAILS VALUES ('221-4713988-62229000','P00001','2');
INSERT INTO SALES_ORDER_DETAILS VALUES ('221-7255722-06001000','P00002','1');
INSERT INTO SALES_ORDER_DETAILS VALUES ('221-7500908-94953000','P00003','2');
INSERT INTO SALES_ORDER_DETAILS VALUES ('223-9854674-14514000','P00004','1');
INSERT INTO SALES_ORDER_DETAILS VALUES ('225-6366641-68866000','P00005','4');
INSERT INTO SALES_ORDER_DETAILS VALUES ('225-6366641-68456526','P00006','1');
INSERT INTO SALES_ORDER_DETAILS VALUES ('225-6366641-66735675','P00007','2');
INSERT INTO SALES_ORDER_DETAILS VALUES ('225-6367346-28388000','P00008','3');
INSERT INTO SALES_ORDER_DETAILS VALUES ('225-6552008-45781000','P00009','2');
INSERT INTO SALES_ORDER_DETAILS VALUES ('226-2785221-01930000','P00010','4');

SELECT * FROM CLIENT_MASTER;
SELECT * FROM PRODUCT_MASTER;
SELECT * FROM SALES_ORDER;
SELECT * FROM SALES_ORDER_DETAILS;

#LIST THE ORDERS PLACED BY RAMEN SEN...
SELECT PRODUCT_MASTER.PRODUCTNUMBER,DESCRIPTION,ORDERQUANTITY FROM CLIENT_MASTER,PRODUCT_MASTER,SALES_ORDER,SALES_ORDER_DETAILS WHERE CLIENT_MASTER.CLIENTNUMBER=SALES_ORDER.CLIENTNUMBER AND SALES_ORDER.ORDERNUMBER=SALES_ORDER_DETAILS.ORDERNUMBER AND SALES_ORDER_DETAILS.PRODUCTNUMBER=PRODUCT_MASTER.PRODUCTNUMBER AND CLIENT_MASTER.CLIENTNAME='RAMEN SEN';

#LIST THE PRODUCT NUMBER AND QUANTITIES ORDERED FOR EACH PRODUCT...
SELECT SALES_ORDER_DETAILS.PRODUCTNUMBER,PRODUCT_MASTER.DESCRIPTION,ORDERQUANTITY FROM PRODUCT_MASTER,SALES_ORDER_DETAILS WHERE PRODUCT_MASTER.PRODUCTNUMBER=SALES_ORDER_DETAILS.PRODUCTNUMBER;

#COUNT THE TOTAL NUMBER OF ORDERS...
SELECT COUNT(ORDERNUMBER) FROM SALES_ORDER;

#DISPLAY THE ORDER INFORMATION FOR CLIENT NUMBER 'C00001' AND 'C00002'...
SELECT SALES_ORDER.CLIENTNUMBER,SALES_ORDER.ORDERNUMBER,DESCRIPTION,ORDERDATES,ORDERQUANTITY FROM CLIENT_MASTER,PRODUCT_MASTER,SALES_ORDER,SALES_ORDER_DETAILS WHERE CLIENT_MASTER.CLIENTNUMBER=SALES_ORDER.CLIENTNUMBER AND SALES_ORDER.ORDERNUMBER=SALES_ORDER_DETAILS.ORDERNUMBER AND SALES_ORDER_DETAILS.PRODUCTNUMBER=PRODUCT_MASTER.PRODUCTNUMBER AND (SALES_ORDER.CLIENTNUMBER='C00001' OR SALES_ORDER.CLIENTNUMBER='C00002');
