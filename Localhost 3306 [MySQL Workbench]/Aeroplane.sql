CREATE DATABASE AEROPLANE;
USE AEROPLANE;
CREATE TABLE FLIGHT(
	FNO VARCHAR(10) PRIMARY KEY,
    FCOMPANY CHARACTER(40) NOT NULL
);
INSERT INTO FLIGHT VALUES('A380','AIRBUS');
INSERT INTO FLIGHT VALUES('B737','BOEING');
INSERT INTO FLIGHT VALUES('I425','INDIGO');
INSERT INTO FLIGHT VALUES('S989','SPICEJET');
INSERT INTO FLIGHT VALUES('V540','VISTARA');
INSERT INTO FLIGHT VALUES('QA125','QATAR AIRWAYS');
INSERT INTO FLIGHT VALUES('A777','AIRINDIA');
INSERT INTO FLIGHT VALUES('A567','AIRASIA');
INSERT INTO FLIGHT VALUES('E326','EMIRATES');

CREATE TABLE PILOT(
	PID VARCHAR(10) PRIMARY KEY,
    PNAME CHARACTER(40) NOT NULL,
    EXPERIENCE SMALLINT NOT NULL,
    SALARY FLOAT NOT NULL
);
INSERT INTO PILOT VALUES('P001','WILBUR AND ORVILLE WRIGHT',20,100000.00);
INSERT INTO PILOT VALUES('P002','GENERAL CHARLES A. LINDBERGH',18,100000.00);
INSERT INTO PILOT VALUES('P003','AMELIA EARHART',20,100000.00);
INSERT INTO PILOT VALUES('P004','BARON MANFRED VON RICHTHOVEN',5,60000.00);
INSERT INTO PILOT VALUES('P005','GENERAL JAMES H. DOOLITTLE',25,120000.00);
INSERT INTO PILOT VALUES('P006','NOEL WIEN',44,160000.00);
INSERT INTO PILOT VALUES('P007','CHESLEY SULLY SULLENBERGER',40,150000.00);
INSERT INTO PILOT VALUES('P008','GENERAL CHARLES E. YEAGER',28,120000.00);
INSERT INTO PILOT VALUES('P009','ERICH HARTMANN',28,120000.00);
INSERT INTO PILOT VALUES('P010','ROBERT A. HOOVER',50,180000.00);

CREATE TABLE SCHEDULE(
	FNO VARCHAR(10) REFERENCES FLIGHT,
    PID VARCHAR(10) REFERENCES PILOT,
    SOURCE_CITY CHARACTER(40) NOT NULL,
    DESTINATION_CITY CHARACTER(40) NOT NULL,
    FLYDATE DATE NOT NULL,
    PRIMARY KEY(FNO, PID)
);
INSERT INTO SCHEDULE (FNO, PID, SOURCE_CITY, DESTINATION_CITY, FLYDATE) VALUES('A380','P003','KOLKATA','MUMBAI','2023-12-18'), ('A380','P006','NORTH AMERICA','SIBERIA','2023-12-21');
INSERT INTO SCHEDULE (FNO, PID, SOURCE_CITY, DESTINATION_CITY, FLYDATE) VALUES('B737','P002','NEW YORK','PARIS','2023-12-20'), ('B737','P004','MUMBAI','GERMANY','2023-12-18');
INSERT INTO SCHEDULE (FNO, PID, SOURCE_CITY, DESTINATION_CITY, FLYDATE) VALUES('I425','P002','KOLKATA','NEW DELHI','2023-12-20'), ('I425','P001','NORTH CAROLINA','SAN FRANSISCO','2023-12-24'), ('I425','P004','KOLKATA','RAJASTHAN','2023-12-22');
INSERT INTO SCHEDULE VALUES('S989','P006','MUMBAI','PORT BLAIR','2023-12-22');
INSERT INTO SCHEDULE VALUES('V540','P007','UNITED STATES OF AMERICA','NEW YORK','2023-12-23');
INSERT INTO SCHEDULE (FNO, PID, SOURCE_CITY, DESTINATION_CITY, FLYDATE) VALUES('QA125','P001','KOLKATA','HYDERABAD','2023-12-21'), ('QA125','P009','NEW DELHI','MUMBAI','2023-12-18');
INSERT INTO SCHEDULE VALUES('A777','P005','KOLKATA','CHENNAI','2023-12-25');
INSERT INTO SCHEDULE VALUES('A567','P008','SILIGURI','BANGALORE','2023-12-18');
INSERT INTO SCHEDULE (FNO, PID, SOURCE_CITY, DESTINATION_CITY, FLYDATE) VALUES('E326','P005','KOLKATA','PORT BLAIR','2023-12-24'),('E326','P008','KOLKATA','VISHAKHAPATNAM','2023-12-25');

SELECT * FROM FLIGHT;
SELECT * FROM PILOT;
SELECT * FROM SCHEDULE;

#FIND OUT THE MOST EXPERIENCED PILOT AND HIS/HER SALARY
SELECT PID,PNAME,EXPERIENCE FROM PILOT WHERE EXPERIENCE IN (SELECT MAX(EXPERIENCE) FROM PILOT);

#FIND OUT THE FLIGHTS WHICH ARE FLYING IN THE DATE '25TH DECEMBER 2023'
SELECT FLIGHT.FNO,FCOMPANY FROM FLIGHT,SCHEDULE WHERE FLIGHT.FNO=SCHEDULE.FNO AND FLYDATE='2023-12-25';

#FIND OUT THE PILOT GETTING THE LOWEST SALARY
SELECT PID,PNAME,SALARY FROM PILOT WHERE SALARY IN (SELECT MIN(SALARY) FROM PILOT);

#FIND OUT THE FLIGHTS WHICH ARE GOING TO 'MUMBAI' ON '18TH DECEMBER 2023'
SELECT FLIGHT.FNO,FCOMPANY FROM FLIGHT,SCHEDULE WHERE FLIGHT.FNO=SCHEDULE.FNO AND DESTINATION_CITY='MUMBAI' AND FLYDATE='2023-12-18';

#FIND OUT THE DETAILS OF ALL FLIGHTS OF 'INDIGO' COMPANY WHICH ARE STARTING FROM CITY 'KOLKATA'
SELECT FLIGHT.FNO,FCOMPANY,PILOT.PID,PNAME,SOURCE_CITY,DESTINATION_CITY,FLYDATE FROM FLIGHT,PILOT,SCHEDULE WHERE FLIGHT.FNO=SCHEDULE.FNO AND SCHEDULE.PID=PILOT.PID AND FCOMPANY='INDIGO' AND SOURCE_CITY='KOLKATA';
