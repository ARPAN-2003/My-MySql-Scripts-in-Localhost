CREATE DATABASE PART;
USE PART;
CREATE TABLE SUPPLIER (
	SUP_ID VARCHAR(10) PRIMARY KEY,
    SUP_NAME VARCHAR(40) NOT NULL,
    SUP_ADDRESS VARCHAR(20)
);
INSERT INTO SUPPLIER VALUES ('S001','RAMCHARAN','KOLKATA');
INSERT INTO SUPPLIER VALUES ('S002','ANUSHKA','DELHI');
INSERT INTO SUPPLIER VALUES ('S003','TARUN','NOIDA');
INSERT INTO SUPPLIER VALUES ('S004','RAMEN','KANPUR');
INSERT INTO SUPPLIER VALUES ('S005','ANUPAMA','HYDERABAD');
INSERT INTO SUPPLIER VALUES ('S006','RAJU','CHENNAI');
INSERT INTO SUPPLIER VALUES ('S007','SOURYA','GOA');
INSERT INTO SUPPLIER VALUES ('S008','ABHISHEK','BANGALORE');
INSERT INTO SUPPLIER VALUES ('S009','ARITRA','MUMBAI');
INSERT INTO SUPPLIER VALUES ('S010','KOUSHIK','KANNYAKUMARI');

CREATE TABLE PARTS (
	PARTID VARCHAR(10) PRIMARY KEY,
    PARTNAME VARCHAR(40) NOT NULL,
    COLOR CHARACTER(10) NOT NULL
);
INSERT INTO PARTS VALUES ('P001','DOOR LATCH','RED');
INSERT INTO PARTS VALUES ('P002','SIDE MIRROR','GREEN');
INSERT INTO PARTS VALUES ('P003','DOOR MOULDING','BLUE');
INSERT INTO PARTS VALUES ('P004','DOOR LOCK','BLUE');
INSERT INTO PARTS VALUES ('P005','COMPRESSOR','RED');
INSERT INTO PARTS VALUES ('P006','DOOR HANDLE','GREEN');

CREATE TABLE TRANSACTION (
	SUP_ID VARCHAR(10),
    PARTID VARCHAR(10),
    COST INTEGER NOT NULL,
    PRIMARY KEY(SUP_ID, PARTID),
    FOREIGN KEY(SUP_ID) REFERENCES SUPPLIER(SUP_ID),
    FOREIGN KEY(PARTID) REFERENCES PARTS(PARTID)
);
INSERT INTO TRANSACTION VALUES ('S001','P004',1000);
INSERT INTO TRANSACTION VALUES ('S002','P005',600);
INSERT INTO TRANSACTION VALUES ('S002','P002',700);
INSERT INTO TRANSACTION VALUES ('S005','P003',600);
INSERT INTO TRANSACTION VALUES ('S007','P001',800);
INSERT INTO TRANSACTION VALUES ('S005','P005',1000);
INSERT INTO TRANSACTION VALUES ('S004','P003',500);
INSERT INTO TRANSACTION VALUES ('S007','P004',700);
INSERT INTO TRANSACTION VALUES ('S001','P002',1000);
INSERT INTO TRANSACTION VALUES ('S010','P006',1000);

SELECT * FROM SUPPLIER;
SELECT * FROM PARTS;
SELECT * FROM TRANSACTION;

#FIND THE SUPPLIER IDS AND NAMES WHO HAD SUPPLIED EITHER SOME RED PARTS OR SOME GREEN PARTS...
SELECT DISTINCT SUPPLIER.SUP_ID,SUP_NAME FROM SUPPLIER,PARTS,TRANSACTION WHERE SUPPLIER.SUP_ID=TRANSACTION.SUP_ID AND TRANSACTION.PARTID=PARTS.PARTID AND (COLOR='RED' OR COLOR='GREEN') ORDER BY SUPPLIER.SUP_ID;

#COUNT THE NUMBER OF SUPPLIERS WHO HAD SUPPLIED PARTS OF ANY COLOR...
SELECT COUNT(SUP_ID) FROM SUPPLIER WHERE EXISTS (SELECT PARTID FROM TRANSACTION WHERE SUPPLIER.SUP_ID=TRANSACTION.SUP_ID);

#FIND THE SUPPLIER IDS AND NAMES WHO HAD NOT SUPPLY ANY PART...
SELECT SUP_ID,SUP_NAME FROM SUPPLIER WHERE NOT EXISTS (SELECT PARTID FROM TRANSACTION WHERE SUPPLIER.SUP_ID=TRANSACTION.SUP_ID);

#COUNT ONLY THE PARTS WHICH ARE NOT RED...
SELECT COUNT(PARTID) FROM PARTS WHERE NOT COLOR='RED';
